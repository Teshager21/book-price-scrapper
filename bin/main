#!/usr/bin/env ruby
require_relative '../lib/page_parser'
require_relative '../lib/data_filter'

(1..1000).each do |i|
  url = 'https://www.amazon.com/Best-Sellers-Books-Deals/zgbs/books/45/ref=zg_bs_pg_1?_encoding=UTF8&pg=' + i.to_s
  page_parser = PageParser.new(url)

  page_parser.bring_unparsed_page
  page_parser.parse_page
  data_filter = DataFilter.new(page_parser.parsed_page)
  break if data_filter.item_cards.count.zero?

  data_filter.product_page
  puts 'LOADING THE NEXT PAGE ...'
  puts 'PRESS e TO STOP SCRAPPING'
  option = gets.chomp
  break if option == 'e'
end
puts count
